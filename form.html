<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SSGen - Server-Side Generation API</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      line-height: 1.6;
      color: #333;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      padding: 40px;
    }
    h1 {
      color: #667eea;
      margin-bottom: 10px;
      font-size: 2.5em;
    }
    .subtitle {
      color: #666;
      margin-bottom: 30px;
      font-size: 1.1em;
    }
    .form-group {
      margin-bottom: 25px;
    }
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #444;
    }
    .help-text {
      font-size: 0.9em;
      color: #666;
      margin-top: 4px;
    }
    textarea, input[type="text"] {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 6px;
      font-size: 14px;
      font-family: inherit;
      transition: border-color 0.3s;
    }
    textarea:focus, input[type="text"]:focus {
      outline: none;
      border-color: #667eea;
    }
    textarea {
      resize: vertical;
      min-height: 120px;
      font-family: 'Courier New', monospace;
    }
    .content-textarea {
      min-height: 200px;
    }
    button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 14px 32px;
      font-size: 16px;
      font-weight: 600;
      border-radius: 6px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      width: 100%;
    }
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
    }
    button:active {
      transform: translateY(0);
    }
    .api-info {
      background: #f8f9fa;
      border-left: 4px solid #667eea;
      padding: 15px;
      margin-bottom: 30px;
      border-radius: 4px;
    }
    .api-info h3 {
      color: #667eea;
      margin-bottom: 10px;
      font-size: 1.2em;
    }
    .api-info code {
      background: #e9ecef;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 0.9em;
    }
    .output-section {
      margin-top: 30px;
      display: none;
    }
    .output-section.visible {
      display: block;
    }
    .output-content {
      background: #f8f9fa;
      border: 2px solid #e0e0e0;
      border-radius: 6px;
      padding: 20px;
      min-height: 200px;
      max-height: 500px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    .loading {
      text-align: center;
      padding: 20px;
      color: #667eea;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üöÄ SSGen</h1>
    <p class="subtitle">Server-Side Generation with AI - API Test Interface</p>
    
    <div class="api-info">
      <h3>About this API</h3>
      <p>This service generates dynamic web pages using AI (Gemini Flash 2.5) from markdown content with streaming support. The API accepts markdown content and generates HTML or text based on your prompts.</p>
      <p style="margin-top: 10px;"><strong>Endpoint:</strong> <code>POST /generate</code> or <code>POST /</code></p>
    </div>

    <form id="generateForm">
      <div class="form-group">
        <label for="content">Markdown Content</label>
        <textarea id="content" name="content" class="content-textarea" placeholder="# Welcome to SSGen&#10;&#10;Enter your markdown content here...">{{DEFAULT_CONTENT}}</textarea>
        <div class="help-text">Enter the markdown content you want to process</div>
      </div>

      <div class="form-group">
        <label for="prompt">User Prompt</label>
        <input type="text" id="prompt" name="prompt" placeholder="Generate an HTML page from this markdown content." value="Generate an HTML page from this markdown content.">
        <div class="help-text">Describe what you want the AI to generate</div>
      </div>

      <div class="form-group">
        <label for="systemPrompt">System Prompt</label>
        <textarea id="systemPrompt" name="systemPrompt" placeholder="You are a helpful assistant...">{{DEFAULT_SYSTEM_PROMPT}}</textarea>
        <div class="help-text">Configure the AI's behavior and role</div>
      </div>

      <button type="submit">Generate Content</button>
    </form>

    <div id="outputSection" class="output-section">
      <h3>Generated Output:</h3>
      <div id="output" class="output-content"></div>
    </div>
  </div>

  <script>
    document.getElementById('generateForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const content = document.getElementById('content').value;
      const prompt = document.getElementById('prompt').value;
      const systemPrompt = document.getElementById('systemPrompt').value;
      
      const outputSection = document.getElementById('outputSection');
      const output = document.getElementById('output');
      
      outputSection.classList.add('visible');
      output.innerHTML = '<div class="loading">‚è≥ Generating content...</div>';
      
      try {
        const response = await fetch('/generate', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            content: content,
            prompt: prompt,
            systemPrompt: systemPrompt
          })
        });
        
        if (!response.ok) {
          throw new Error('Failed to generate content');
        }
        
        // Handle streaming response
        const reader = response.body.getReader();
        const decoder = new TextDecoder();
        output.innerHTML = '';
        
        while (true) {
          const { done, value } = await reader.read();
          if (done) break;
          
          const chunk = decoder.decode(value, { stream: true });
          output.innerHTML += chunk;
          output.scrollTop = output.scrollHeight;
        }
      } catch (error) {
        output.textContent = 'Error: ' + (error instanceof Error ? error.message : 'Unknown error occurred');
      }
    });
  </script>
</body>
</html>
